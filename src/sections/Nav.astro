<!-- NAVEGACIÓN -->
<div class="fixed top-0 left-0 w-full z-50">
  <nav
    id="main-nav"
    class="p-4 transition-all duration-500"
    style="font-family: 'Noto Serif Variable', serif;"
  >
    <div
      class="max-w-7xl mx-auto flex items-center justify-between md:grid md:grid-cols-3"
    >
      <!-- Logo -->
      <div class="flex items-center">
        <a href="/" class="flex items-center text-lg md:text-2xl gap-1 group">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="w-6 h-6 md:w-8 md:h-8 text-yellow-400 group-hover:scale-110 transition-transform"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M4 3h16"></path>
            <path d="M7 3v18"></path>
            <path d="M17 3v18"></path>
          </svg>
          <span class="font-black tracking-tighter text-white">LUXE</span>
        </a>
      </div>

      <!-- Links desktop -->
      <div class="hidden md:flex justify-center gap-8">
        <a
          href="/historia"
          class="text-sm font-bold uppercase tracking-widest text-white/70 hover:text-yellow-400 transition-colors"
          >Historia</a
        >
        <a
          href="/menu"
          class="text-sm font-bold uppercase tracking-widest text-white/70 hover:text-yellow-400 transition-colors"
          >Menú</a
        >
        <a
          href="/#contacto"
          class="text-sm font-bold uppercase tracking-widest text-white/70 hover:text-yellow-400 transition-colors"
          >Contacto</a
        >
      </div>

      <!-- Botón reserva (Desktop) -->
      <div class="flex items-center justify-end gap-6">
        <a
          href="/reserva"
          class="hidden md:block bg-yellow-400 hover:bg-white px-6 py-2 rounded font-black text-xs text-black uppercase tracking-widest transition-all shadow-lg shadow-yellow-400/10"
        >
          Reserva
        </a>

        <!-- Placeholder para mantener el espacio en la grid en móvil -->
        <div class="w-10 h-10 md:hidden"></div>
      </div>
    </div>
  </nav>

  <!-- BOTÓN HAMBURGUER (FUERA DEL NAV PARA EVITAR STACKING CONTEXT) -->
  <button
    id="menu-toggle"
    class="fixed top-4 right-4 z-[100] w-12 h-12 flex flex-col justify-center items-center gap-1.5 md:hidden focus:outline-none group bg-black/20 backdrop-blur-lg rounded-full border border-white/5"
    aria-label="Toggle menú"
  >
    <span
      class="w-6 h-0.5 bg-yellow-400 transition-all duration-300 origin-center"
      id="bar1"></span>
    <span class="w-6 h-0.5 bg-yellow-400 transition-all duration-300" id="bar2"
    ></span>
    <span
      class="w-6 h-0.5 bg-yellow-400 transition-all duration-300 origin-center"
      id="bar3"></span>
  </button>

  <!-- OVERLAY MENÚ MÓVIL -->
  <div
    id="mobile-menu"
    class="fixed inset-0 bg-black/98 backdrop-blur-2xl z-60 flex flex-col items-center justify-center gap-8 transition-all duration-500 opacity-0 pointer-events-none"
  >
    <div class="flex flex-col items-center gap-8 text-center">
      <a
        href="/historia"
        class="mobile-link text-3xl font-black uppercase tracking-[0.3em] text-white hover:text-yellow-400 transition-colors opacity-0 translate-y-8"
        >Historia</a
      >
      <a
        href="/menu"
        class="mobile-link text-3xl font-black uppercase tracking-[0.3em] text-white hover:text-yellow-400 transition-colors opacity-0 translate-y-8"
        >Menú</a
      >
      <a
        href="/#contacto"
        class="mobile-link text-3xl font-black uppercase tracking-[0.3em] text-white hover:text-yellow-400 transition-colors opacity-0 translate-y-8"
        >Contacto</a
      >

      <div
        class="w-12 h-0.5 bg-yellow-400/30 my-4 mobile-link opacity-0 translate-y-8"
      >
      </div>

      <a
        href="/reserva"
        class="mobile-link bg-yellow-400 px-10 py-4 rounded font-black text-black uppercase tracking-widest opacity-0 translate-y-8 shadow-2xl shadow-yellow-400/20"
      >
        Reservar Mesa
      </a>
    </div>

    <!-- Redes en el menú móvil -->
    <div
      class="absolute bottom-12 flex gap-8 mobile-link opacity-0 translate-y-8"
    >
      <span class="text-white/30 text-[10px] tracking-[0.3em] uppercase"
        >Instagram</span
      >
      <span class="text-white/30 text-[10px] tracking-[0.3em] uppercase"
        >Facebook</span
      >
    </div>
  </div>
</div>

<style>
  /* Animación Icono Hamburguesa */
  #menu-toggle.active #bar1 {
    transform: translateY(8px) rotate(45deg);
  }
  #menu-toggle.active #bar2 {
    opacity: 0;
    transform: translateX(-20px);
  }
  #menu-toggle.active #bar3 {
    transform: translateY(-8px) rotate(-45deg);
  }

  /* Estado Abierto del Menú */
  #mobile-menu.active {
    opacity: 1;
    pointer-events: auto;
  }

  #mobile-menu.active .mobile-link {
    animation: fadeInUpStagger 0.5s ease forwards;
  }

  @keyframes fadeInUpStagger {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Delays para el escalonado */
  .mobile-link:nth-child(1) {
    animation-delay: 0.1s;
  }
  .mobile-link:nth-child(2) {
    animation-delay: 0.2s;
  }
  .mobile-link:nth-child(3) {
    animation-delay: 0.3s;
  }
  .mobile-link:nth-child(4) {
    animation-delay: 0.4s;
  }
  .mobile-link:nth-child(5) {
    animation-delay: 0.5s;
  }
  .mobile-link:nth-child(6) {
    animation-delay: 0.6s;
  }

  /* Efecto scroll nave */
  #main-nav.scrolled {
    background-color: rgba(18, 17, 10, 0.9);
    backdrop-filter: blur(12px);
    padding-top: 0.75rem;
    padding-bottom: 0.75rem;
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
  }
</style>

<script>
  function initNav() {
    const menuToggle = document.getElementById("menu-toggle");
    const mobileMenu = document.getElementById("mobile-menu");
    const nav = document.getElementById("main-nav");
    const links = document.querySelectorAll(".mobile-link");

    // Toggle Menu
    menuToggle?.addEventListener("click", () => {
      const isOpened = menuToggle.classList.toggle("active");
      mobileMenu?.classList.toggle("active");

      // Bloquear scroll del body
      document.body.style.overflow = isOpened ? "hidden" : "auto";
    });

    // Cerrar al hacer clic en un link
    links.forEach((link) => {
      link.addEventListener("click", () => {
        menuToggle?.classList.remove("active");
        mobileMenu?.classList.remove("active");
        document.body.style.overflow = "auto";
      });
    });

    // Efecto scroll
    window.addEventListener("scroll", () => {
      if (window.scrollY > 50) {
        nav?.classList.add("scrolled");
      } else {
        nav?.classList.remove("scrolled");
      }
    });
  }

  // Soporte para View Transitions
  document.addEventListener("astro:page-load", initNav);
</script>
